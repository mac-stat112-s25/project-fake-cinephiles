---
title: "Combining the Letterboxd and IMDb Datasets"
format: html
---

# Import datasets and clean them using steps established in cleaning files {.unnumbered}
```{r}
library(tidyverse)
library(stringr)

# import data
imdb_messy <- read_csv("..\\data\\imdb_movie_dataset.csv")

# clean the data
imdb_cleaned <- imdb_messy |>
  select(Title,Rating) |> # select only title and rating
  drop_na(Title, Rating)

# import data
letterboxd_data <- read_csv("..\\data\\letterboxd_250movie_reviews.csv")

letterboxd_convertStars <-letterboxd_data |>
  mutate(numerical_rating = fct_recode(Rating, "5" = "★★★★★",
                                       "4.5" = "★★★★½", 
                                        "4" = "★★★★",
                                       "3.5" = "★★★½",
                                        "3" = "★★★",
                                        "2.5" = "★★½", 
                                        "2" = "★★",
                                       "1.5" =  "★½",
                                        "1" = "★",
                                       ".5" = "½"))

letterboxd_clean <- letterboxd_convertStars |>
  filter(!is.na(numerical_rating)) |>
  mutate(
    numerical_rating = as.numeric(as.character(numerical_rating)),
    out_of_ten = numerical_rating *2) |>
  group_by(Movie) |>
  summarise(
    avg_rating = mean(out_of_ten, na.rm = TRUE),
  ) |> 
arrange(desc(avg_rating))
```
#Alter the IMDb titles to match the formatting of the letterboxd data, update letterboxd column name {.unnumbered}
```{r}
imdb_cleaned_standardized <- imdb_cleaned |>
  mutate(Title = Title |> 
           str_to_lower() |>         # make lowercase
           str_replace_all(" ", "-") |> # replace spaces with hyphens
           str_replace_all("[^a-z0-9\\-]", "")  # remove punctuation
         )

letterboxd_clean_renamed <- letterboxd_clean |>
  rename(Title = Movie)

```

# Join datasets {.unnumbered}

```{r}
merged_ratings <- inner_join(letterboxd_clean_renamed, imdb_cleaned_standardized, by = "Title") |>
  rename(
    letterboxd_score = avg_rating,
    imdb_score = Rating
  )

head(merged_ratings)
```



